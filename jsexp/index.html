<!DOCTYPE html>
<html lang="en">
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>Expression evaluation test</title>

  
  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
</head>
<body>
  <nav class="light-blue lighten-1" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" href="#" class="brand-logo">JS Expression Engine</a>
      <ul class="right hide-on-med-and-down">
        <li><a href="#"></a></li>
      </ul>
     
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
  </nav>
  <div class="section no-pad-bot" id="index-banner">
    <div class="container">
      <br><br>     
      <div class="row center">
         
        <div class="row">
          <div class="col s12">
            <ul class="tabs">
              <li class="tab col s2"><a href="#test1">Yes/No</a></li>
              <li class="tab col s2"><a  href="#test2">Num/Demo</a></li>
              <li class="tab col s2"><a href="#test3">Multichoice</a></li>
              <li class="tab col s2"><a href="#test4">Volume</a></li>
              <li class="tab col s2"><a href="#test5">TextInput</a></li>
              <li class="tab col s3"><a href="#test6">Custom Expression</a></li>
            </ul>
          </div>
          <div id="test1" class="col s12">
		  
		   <div class="row">
                  <div class="col s12">
                    
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title">Yes/No</span>
                        <p> Yes = 3 , No = 0</p>
                      </div>                     
                    </div>                    
                  
                   </div>
                  <div class="col s8">
                      <div class="row">
                       <div class="input-field col s12">
                        <textarea   class="materialize-textarea" id="ynJSON">                         
{
"func":"multichoice", 
"params":["input"],
"config":{"yes":3,"no":0}
}
                       
                         </textarea>
                        <label for="textarea1">JSON Metadata(Change config 'yes'/'no' value)</label>
                      </div>
                      </div>
                  </div>
                  <div class="col s4">
                    <div class="row">
                       <div class="input-field col s12">
                       
                          <select id="ynSel">
                            <option value="" selected id="selopt1">Choose your option</option>
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                          </select>
                          <label>Choice</label>					   
                      </div>
					  
                      <div class="input-field col s12">
                        <button class="btn waves-effect waves-light" id="ynEval" type="submit" name="action">Evaluate
                         <i class="material-icons right">send</i>
                        </button>
                       </div>
                       
                       
                    </div>  
                    
                   </div>
                   
                    <div class="col s12">
                    
                    <div class="card lime lighten-2">
                      <div class="card-content left-align">
                        <span class="card-title">Result:</span>
                        <p id="rslt1"></p>
                      </div>                     
                    </div>                    
                  
                   </div>
                   
                </div>
		  
		  
		  </div>
		  
          <div id="test2" class="col s12">
          
            <div class="row">
                  <div class="col s12">
                    
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title">Num /Denom</span>
                        <p> Denom	&lt; 25	0, Rate	$gt;=95%	3, rate	&gt;=80%	2, rate	&lt;80%	0, Optout		0</p>
                      </div>                     
                    </div>                    
                  
                   </div>
                  <div class="col s8">
                      <div class="row">
                       <div class="input-field col s12">
                        <textarea   class="materialize-textarea" id="ndJSON">                         
{ "func":"genNumberND",                        
  "params":["rate","num","denom"],
  "config":[
		   {                   
			  "exp":{"left":"denom", "right":25, "operator":"<"},
			  "rslt":0
		   },
		   {
			  "exp":{"left":"rate", "right":95, "operator":">="},
			  "rslt":3
		   },
		   {
			  "type":"and",
					 "exp":[
							  {"left":"rate", "right":95, "operator":"<"},
							  {"left":"rate", "right":80, "operator":">="}
					 ],
			  "rslt":2
		   },
		   {                    
			  "exp":{"left":"rate", "right":80, "operator":"<"},
			  "rslt":0
		   }
	]
}                    
                         </textarea>
                        <label for="textarea1">JSON Metadata(Change only 'rslt' value)</label>
                      </div>
                      </div>
                  </div>                 
                  <div class="col s4">
                    <div class="row">
                         <div class="input-field col s12">
                          <input placeholder="Enter numerator" id="ndInputN" type="text" class="validate">
                          <label for="first_name">Numerator</label>
                        </div>
                         <div class="input-field col s12">
                          <input placeholder="Enter denominator" id="ndInputD" type="text" class="validate">
                          <label for="first_name">Denominator</label>
                        </div>
                        <div class="input-field col s12">
                          <input placeholder="Rate(calculated)" id="ndInputR" readonly type="text" class="validate">
                          <label for="first_name">Rate</label>
                        </div>
          
                          <div class="input-field col s12">
                            <select> 
                              <option value="" disabled selected>Choose your option</option>
                              <option value="1">Option 1</option>
                              <option value="2">Option 2</option>
                              <option value="3">Option 3</option>
                            </select>
                            <label>Materialize Select</label>
                          </div>
          
          
          
                         <div class=" col s12">
                           <button class="btn waves-effect waves-light" id="ndEval" type="submit" name="action">Evaluate
                             <i class="material-icons right">send</i>
                          </button>
                        </div> 
                        </div>
                   </div>
                   
                    <div class="col s12">
                    
                    <div class="card lime lighten-2">
                      <div class="card-content left-align">
                        <span class="card-title">Result:</span>
                        <p id="rslt2"></p>
                        <p id="rslt2Exp"></p>
                      </div>                     
                    </div>                    
                  
                   </div>
                   
                </div>
          
          
          </div>
          
          
          <div id="test3" class="col s12">
            <!-- multichoice tab start-->
            <div class="row">
                  <div class="col s12">
                    
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title">Multichoice</span>
                        <p> Stage1 = 4, Stage2 = 5, Stage3 = 2, Optout = 0</p>
                      </div>                     
                    </div>                    
                  
                   </div>
                  <div class="col s8">
                      <div class="row">
                       <div class="input-field col s12">
                        <textarea   class="materialize-textarea" id="mcJSON">                         
{
"func":"multichoice", 
"params":["input"],
"config":{"stage1":4,"stage2":5, "stage3":2}
}
                       
                         </textarea>
                        <label for="textarea1">JSON Metadata(Change config 'stage' value)</label>
                      </div>
                      </div>
                  </div>
                  <div class="col s4">
                    <div class="row">
                       <div class="input-field col s12">
                       
                          <select id="mcSel">
                            <option value="" selected>Choose your option</option>
                            <option value="stage1">Stage 1</option>
                            <option value="stage2">Stage 2</option>
                            <option value="stage3">Stage 3</option>
                          </select>
                          <label>Choice</label>					   
                      </div>
					  
                      <div class="input-field col s12">
                        <button class="btn waves-effect waves-light" id="mcEval" type="submit" name="action">Evaluate
                         <i class="material-icons right">send</i>
                        </button>
                       </div>

                    </div>                   
                   </div>
                   
                    <div class="col s12">
                    
                    <div class="card lime lighten-2">
                      <div class="card-content left-align">
                        <span class="card-title">Result:</span>
                        <p id="mc_rslt"></p>
                      </div>                     
                    </div>                    
                  
                   </div>
                   
                </div>
            <!-- mutlichoice tab end -->
          </div>
          <div id="test4" class="col s12">
            <!-- volume tab start -->
            
            <div class="row">
                  <div class="col s12">
                    
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title">Volume / Rate / Ratio</span>
                        <p> >=95%	= 3, >=80%	= 2, &lt;80%	= 0 </p>
                      </div>                     
                    </div>                    
                  
                   </div>
                  <div class="col s8">
                      <div class="row">
                       <div class="input-field col s12">
                        <textarea   class="materialize-textarea" id="volJSON">                         
{        "func":"genNumber",                                  
  "params":["input"],
  "config":[
		   {                   
			  "exp":{"left":"input", "right":95, "operator":">="},
			  "rslt":3
		   },
		   {
			  "type":"and",
					 "exp":[
							  {"left":"input", "right":95, "operator":"<"},
							  {"left":"input", "right":85, "operator":">="}
					 ],
			  "rslt":4
		   },
		   {                    
			  "exp":{"left":"input", "right":80, "operator":"<"},
			  "rslt":5
		   }
  ]
}                       
                         </textarea>
                        <label for="textarea1">JSON Metadata</label>
                      </div>
                      </div>
                  </div>
                
                   
                  <div class="col s4">
                    <div class="row">
                       <div class="input-field col s12">
                        <input placeholder="Enter input value here" id="txtInputVol" type="text" class="validate">
                        <label for="first_name">Input</label>
                      </div>
                      
                       <div class="input-field col s12">
                         <button class="btn waves-effect waves-light" id="volEval" type="submit" name="action">Evaluate
                           <i class="material-icons right">send</i>
                        </button>
                      </div>
                      
                      </div>                   
                   </div>
                   
                    <div class="col s12">
                    
                    <div class="card lime lighten-2">
                      <div class="card-content left-align">
                        <span class="card-title">Result:</span>
                        <p id="rsltVol"></p>
                      </div>                     
                    </div>                    
                  
                   </div>
                   
                </div>
            
            <!-- volume tab end -->
          </div>
          <div id="test5" class="col s12">
                 <div class="row">
                  <div class="col s12">
                    
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title">TextInput / Services / Contacts</span>
                        <p> Data Submitted = 3 , Not Answered = 0</p>
                      </div>                     
                    </div>                    
                  
                   </div>
                  <div class="col s8">
                      <div class="row">
                       <div class="input-field col s12">
                        <textarea   class="materialize-textarea" id="txtJSON">                         
{
  "func": "validData",
  "params": [
      "input"
  ],
  "config": {
      "rslt": 3
  }
}                        
                         </textarea>
                        <label for="textarea1">JSON Metadata(Change only 'rslt' value)</label>
                      </div>
                      </div>
                  </div>
                
                   
                  <div class="col s4">
                    <div class="row">
                       <div class="input-field col s12">
                        <input placeholder="Enter input value here" id="txtInput" type="text" class="validate">
                        <label for="first_name">Input</label>
                      </div>
                      
                       <div class="input-field col s12">
                         <button class="btn waves-effect waves-light" id="txtEval" type="submit" name="action">Evaluate
                           <i class="material-icons right">send</i>
                        </button>
                      </div>
                      
                      </div>                   
                   </div>
                   
                    <div class="col s12">
                    
                    <div class="card lime lighten-2">
                      <div class="card-content left-align">
                        <span class="card-title">Result:</span>
                        <p id="rslt5"></p>
                      </div>                     
                    </div>                    
                  
                   </div>
                   
                </div>
                <!-- textinput tab end -->
           </div>
           
           <div id="test6" class="col s12">
             <!-- customexpression tab start -->
             
             <div class="row">
                  <div class="col s12">
                    
                    <div class="card blue-grey darken-1">
                      <div class="card-content white-text">
                        <span class="card-title">Custom Expression via JSON</span>
                        <p> </p>
                      </div>                     
                    </div>                    
                  
                   </div>
                  <div class="col s8">
                      <div class="row">
                       <div class="input-field col s12">
                          <textarea   class="materialize-textarea" id="expJSON">             

{	"func":"evaluate",
	"params":["value1","value2","value3"],
	"config":[
		 {
		   "type":"and",
  			"exp":[
  				{"left":"value1", "right":"yes", "operator":"=="},
  				{"left":"value2", "right":"yes", "operator":"=="},
  				{"left":"value3", "right":"yes", "operator":"!="}
  			]
		 }
	]
}


                       </textarea>
                        <label for="textarea1">JSON Metadata (Change rule and 'param' names)</label>
                      </div>
                      </div>
                  </div>
                
                   
                  <div class="col s4">
                    <div class="row">
                       
                                              <div class="input-field col s12">
                        <textarea   class="materialize-textarea" id="cJSONInput">                         
{
  "value1":"yes", 
  "value2":"yes",
  "value3":"no"
}                        
                         </textarea>
                        <label for="textarea1">JSON Input</label>
                      </div>
                       
                      
                       <div class="input-field col s12">
                         <button class="btn waves-effect waves-light" id="evalCS" type="submit" name="action">Evaluate
                           <i class="material-icons right">send</i>
                        </button>
                      </div>
                      
                      </div>                   
                   </div>
                   
                    
                      
                    <div class="col s12">
                  
                    <div class="card lime lighten-2">
                      <div class="card-content left-align">
                        <span class="card-title" id="exprslt">Result: </span>
                         <p id="rslt_exp" class=" left-align"></p>
                      </div>                     
                    </div>                    
                  
                   </div>
             
             </div>
             <!-- customexpression tab end -->
           </div>
           
        </div>    

    </div>
    </div>


  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="bower_components/materialize/dist/js/materialize.min.js"></script>
    <script type="text/javascript" src="base_lib.js"></script>
  <script src="js/init.js"></script>
 <script type="text/javascript" >
       $(document).ready(function(){
          $('ul.tabs').tabs();
          $('select').not('.disabled').material_select();
		   
	$("#evalCS").click(function() {
	   
	   var jsontext = $("#expJSON").val();
     var expJSON = JSON.parse( jsontext );
     
     var jsontext = $("#cJSONInput").val();
     var cJSONInput = JSON.parse( jsontext );
	    
	      var expression = EvelLib.genExpImpl(expJSON.config, cJSONInput );
	    $("#rslt_exp").html(expression);
	    
	     var rslt = evalExpressionObj( expJSON, cJSONInput);  
	    console.log("Result:"+rslt);
	    $("#exprslt").html("Result: "+rslt);
	  
	});
	
	
		  $("#mcEval").click(function(){
		  
		      var jsontext = $("#mcJSON").val();
           var metadata = JSON.parse( jsontext );
		  
			  var selVal = $.trim( $("#mcSel").val() );
			  
			  var rslt = evalExpressionObj( metadata, selVal.length > 0 ? {input:selVal} : null);  
			  console.log(rslt);
			  $("#mc_rslt").html(rslt);
		  });
		   
		  $("#volEval").click(function() {
		       var jsontext = $("#volJSON").val();
           var metadata = JSON.parse( jsontext );
		  
			  var selVal = $.trim( $("#txtInputVol").val() );
			  
			  var rslt = evalExpressionObj( metadata, selVal.length > 0 ? {input:selVal} : null);  
			  console.log(rslt);
			  $("#rsltVol").html(rslt);
		  });
		   
		   
		  $("#ynEval").click(function(){
		  
		      var jsontext = $("#ynJSON").val();
           var metadata = JSON.parse( jsontext );
			 
			  
			    var selVal = $.trim( $("#ynSel").val() );
			  
			  var rslt = evalExpressionObj( metadata, selVal.length > 0 ? {input:selVal} : null);  
			 
			  console.log(rslt);
			  $("#rslt1").html(rslt);
		  });
         
          $("#ndEval").click(function(){
          
               var jsontext = $("#ndJSON").val();
               var metadata = JSON.parse( jsontext );
               var denom = $("#ndInputD").val();
              var nume = $("#ndInputN").val();
          
             var numVal = parseInt(nume);
             var denVal = parseInt(denom);
             var rate = numVal / denVal;
           
              $("#ndInputR").val(rate);
          
              var input = {rate: rate, num:40, denom:30 };
              console.log(metadata);
              console.log(input);
          
             var rslt = evalExpressionObj( metadata, input );
             console.log("Result:"+rslt);
              $("#rslt2").html(rslt);
          
          $("#rslt2Exp").html("JSScript::"+EvelLib.genExpImpl(metadata.config));
          
              
          });
          
          $("#txtEval").click(function(){
           
            var jsonstr = $("#txtJSON").val();
            var metadata = JSON.parse(jsonstr);
            var val = $.trim($("#txtInput").val());            
            var valobj = val.length > 0 ? {input:val} : null;
            
            console.log(metadata);
            console.log(valobj); 
            
            var data = evalExpressionObj( metadata, valobj);
            console.log(data);
            $("#rslt5").html(data);
          });
         
        });
      </script>
  </body>
</html>
